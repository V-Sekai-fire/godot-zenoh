repos:
  # Basic pre-commit hooks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
        files: \.(rs|md|yaml|yml|toml)$
      - id: end-of-file-fixer
        files: \.(rs|md|yaml|yml|toml)$
      - id: check-yaml
      - id: check-toml
      - id: check-merge-conflict

  # Rust formatting and linting
  - repo: local
    hooks:
      - id: cargo-fmt
        name: Rust formatting
        entry: cargo fmt --
        language: system
        files: \.(rs)$
        pass_filenames: false
      - id: cargo-clippy
        name: Rust linting
        entry: cargo clippy --all-targets
        language: system
        files: \.(rs)$
        pass_filenames: false

  # Markdown formatting
  - repo: https://github.com/executablebooks/mdformat
    rev: 0.7.17
    hooks:
      - id: mdformat
        additional_dependencies:
          - mdformat-gfm
        args: [--wrap=88]

  # Custom emoji checker
  - repo: local
    hooks:
      - id: emoji-free-code
        name: Check for prohibited emojis in code
        entry: python3
        language: system
        files: \.(rs|md)$
        pass_filenames: true
        args:
          - -c
          - |
            import sys
            import os

            prohibited_emojis = [
                # Common emojis
                'ğŸŒ', 'ğŸš€', 'âœ…', 'âŒ', 'ğŸ“Š', 'âš ï¸', 'ğŸ›°ï¸', 'â±ï¸', 'ğŸ“¡', 'ğŸ¯',
                'ğŸ†', 'ğŸ§®', 'ğŸ”—', 'ğŸ“¨', 'ğŸ’¡', 'ğŸš€', 'âš¡', 'ğŸ”¥', 'ğŸ®', 'ğŸ¯',
                'ğŸ“¢', 'â±ï¸', 'ğŸ“¥', 'ğŸ“¤', 'ğŸ‘‚', 'ğŸ”Œ',
                # Unicode mathematical operators (don't display on Windows)
                'Ã—', 'Ã·', 'âˆš', 'âˆ‘', 'âˆ', 'âˆ†', 'âˆ‡', 'âˆ‚', 'âˆ«', 'âˆ®', 'â‰ˆ', 'â‰ ',
                'â‰¤', 'â‰¥', 'âˆˆ', 'âˆ‰', 'âŠ‚', 'âŠƒ', 'âˆª', 'âˆ©', 'âˆ§', 'âˆ¨', 'Â¬', 'âˆ€', 'âˆƒ',
                # Unicode superscripts/subscripts and arrows
                'Â²', 'Â³', 'Â¹', 'â°', 'â´', 'âµ', 'â¶', 'â·', 'â¸', 'â¹', 'â‚', 'â‚‚', 'â‚ƒ', 'â‚€',
                'â†’', 'â†', 'â†‘', 'â†“', 'â†”', 'â‡’', 'â‡', 'â‡”', 'âŸ¨', 'âŸ©', 'âŒŠ', 'âŒ‹', 'âŒˆ', 'âŒ‰',
                # Unicode replacement character and box drawing chars
                '\ufffd'
            ]

            for filepath in sys.argv[1:]:
                if os.path.exists(filepath):
                    with open(filepath, 'r', encoding='utf-8') as f:
                        content = f.read()

                    found_emojis = []
                    for emoji in prohibited_emojis:
                        if emoji in content:
                            found_emojis.append(emoji)

                    if found_emojis:
                        print(f"ERROR: Found prohibited emojis in {filepath}: {', '.join(found_emojis)}")
                        sys.exit(1)
